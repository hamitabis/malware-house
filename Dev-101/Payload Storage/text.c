#include <Windows.h>
#include <stdio.h>

int main(void) {
  UCHAR shellcode[] = "\x90\x90\x90";
  LPVOID allocateMemory = VirtualAlloc(NULL, sizeof shellcode, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);

  if (!allocateMemory)
    (void)fprintf(stderr, "Virtual Alloc failed!");

  CopyMemory(allocateMemory, shellcode, sizeof shellcode);
  HANDLE createThread = CreateThread(NULL, 0, allocateMemory, NULL, 0, NULL);

  if (!createThread)
    (void)fprintf(stderr, "Virtual Alloc failed!");

  WaitForSingleObject(createThread, INFINITE);
}
