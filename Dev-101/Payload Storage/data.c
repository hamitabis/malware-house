#include <Windows.h>
#include <stdio.h>

UCHAR shellcode[] = "\x90\x90\x90";

int main(void) {
  LPVOID allocateMemory = VirtualAlloc(NULL, sizeof shellcode, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
  
  if (!allocateMemory) 
    (void)fprintf(stderr, "Virtual Alloc failed!");
  
  CopyMemory(allocateMemory, shellcode, sizeof shellcode);
  HANDLE createThread = CreateThread(NULL, 0, allocateMemory, NULL, 0, NULL);
  
  if (!createThread) 
    (void)fprintf(stderr, "CreateThread failed!");
  
  WaitForSingleObject(createThread, INFINITE);
}
